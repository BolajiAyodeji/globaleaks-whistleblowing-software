<div class="reveal">
    <div id="Toolbar" class="row">
        <div class="col-md-12">
            <a id="link-tiplist" href="#/recipient/reports" data-toggle="tooltip" title="{{'Reports' | translate}}"
                class="btn btn-outline-secondary">
                <i class="fa-solid fa-arrow-left"></i>
            </a>
            <span id="tip-action-grant-access" *ngIf="preferencesService.dataModel.can_grant_access_to_reports"
                (click)="openGrantTipAccessModal()" data-toggle="tooltip" title="{{'Grant access' | translate}}"
                class="btn btn-outline-secondary">
                <i class="fa-solid fa-user-plus"></i>
            </span>
            <span id="tip-action-revoke-access" *ngIf="preferencesService.dataModel.can_grant_access_to_reports"
                (click)="openRevokeTipAccessModal()" data-toggle="tooltip" title="{{'Revoke access' | translate}}"
                class="btn btn-outline-secondary">
                <i class="fa-solid fa-user-minus"></i>
            </span>
            <span id="tip-action-transfer-access" *ngIf="preferencesService.dataModel.can_transfer_access_to_reports"
                (click)="openTipTransferModal()" data-toggle="tooltip" title="{{'Transfer access' | translate}}"
                class="btn btn-outline-secondary">
                <i class="fa-solid fa-people-arrows"></i>
            </span>
            <span id="tip-action-submit-form"
                (click)="submitForm()" data-toggle="tooltip" title="{{'Submit review form' | translate}}"
                class="btn btn-outline-secondary">
                <i class="fa-solid fa-paper-plane"></i>
            </span>
            <span id="link-reload" (click)="reload()" data-toggle="tooltip" title="{{'Refresh' | translate}}"
                class="btn btn-outline-secondary">
                <i class="fa-solid fa-sync"></i>
            </span>
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-md-12">
            <src-tip-info [loading]="loading" [tipService]="RTipService"></src-tip-info>
        </div>
    </div>
    <ng-container *ngIf="tip && tip.receivers">
        <div class="row" *ngIf="tip.receivers.length > 1">
            <div class="col-md-12">
                <src-tip-receiver-list [tipService]="RTipService"></src-tip-receiver-list>
            </div>
        </div>
    </ng-container>
    <div class="row">
        <div class="col-md-6">
            <div id="TextCard" class="card card-default">
                <div class="card-header d-flex justify-content-between">
                    <span>Text</span>
                </div>
                <div class="card-body">
                    <span>{{questionnaireData.textareaAnswer}}</span>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <src-tip-oe-form [fields]="questionnaireData.reviewFormFields"></src-tip-oe-form>
            <!-- <src-form [identity_provided]=false (notifyFileUpload)="notifyFileUpload.emit()" [uploads]="uploads"  [fileUploadUrl]="fileUploadUrl" [displayErrors]="displayErrors" [entry]="entry" [answers]="answers" [step]="step" [submission]="submission" [index]="index"></src-form> -->
        </div>
    </div>
    <ul ngbNav #nav="ngbNav" class="nav-tabs" [(activeId)]="active">
        <ng-container *ngFor="let tab of tabs">
            <li [ngbNavItem]="tab.title">
                <button ngbNavLink>{{ tab.title | translate }}</button>
                <ng-template ngbNavContent>
                    <ng-container *ngTemplateOutlet="tab.component"></ng-container>
                </ng-template>
            </li>
        </ng-container>
    </ul>
    <div [ngbNavOutlet]="nav" class="mt-2"></div>
    <div class="row">
        <ng-template #tab1>
            <div class="col-md-12">

                <src-tip-files-receiver [redactMode]="redactMode" [forwardings]="tip.forwardings"></src-tip-files-receiver>

                <ng-container *ngIf="tip && tip.context">
                    <src-tip-comments [tipService]="RTipService" [redactOperationTitle]="redactOperationTitle"
                        [redactMode]="redactMode" [key]="'whistleblower'"></src-tip-comments>
                </ng-container>
            </div>
        </ng-template>
        <ng-template #tab2>
            <div class="col-md-12">

                <!-- <src-tip-upload-wbfile [tip]="tip" (dataToParent)="listenToFields()"
                    [key]="'oe'" [canUpload]="false"></src-tip-upload-wbfile> -->
                <src-tip-oe-rfiles-receiver [key]="'oe'"></src-tip-oe-rfiles-receiver>


                <ng-container *ngIf="tip && tip.context">
                    <src-tip-comments [tipService]="RTipService" [redactOperationTitle]="redactOperationTitle"
                        [redactMode]="redactMode" [key]="'oe'"></src-tip-comments>
                </ng-container>
            </div>
        </ng-template>
        <ng-template #tab3>
            <div class="col-md-12">

                <!-- <src-tip-upload-wbfile [tip]="tip" (dataToParent)="listenToFields()"
                    [key]="'internal'"></src-tip-upload-wbfile> -->
                <src-tip-oe-rfiles-receiver [key]="'internal'"></src-tip-oe-rfiles-receiver>

                <ng-container *ngIf="tip && tip.context">
                    <src-tip-comments [tipService]="RTipService" [redactOperationTitle]="redactOperationTitle"
                        [redactMode]="redactMode" [key]="'internal'"></src-tip-comments>
                </ng-container>
            </div>
        </ng-template>
        <ng-template #tab4>
            <div class="col-md-12">
                <!-- <src-tip-upload-wbfile [tip]="tip" (dataToParent)="listenToFields()"
                    [key]="'personal'"></src-tip-upload-wbfile> -->
                
                <src-tip-oe-rfiles-receiver [key]="'personal'"></src-tip-oe-rfiles-receiver>

                <ng-container *ngIf="tip && tip.context">
                    <src-tip-comments [tipService]="RTipService" [redactOperationTitle]="redactOperationTitle"
                        [redactMode]="redactMode" [key]="'personal'"></src-tip-comments>
                </ng-container>
            </div>
        </ng-template>
    </div>
</div>
